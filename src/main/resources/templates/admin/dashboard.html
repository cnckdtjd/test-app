<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test App - 관리자 대시보드</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" th:href="@{/}">Test App</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/admin}">대시보드</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/admin/users}">사용자 관리</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/admin/products}">상품 관리</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/admin/orders}">주문 관리</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-person-circle me-1"></i>
                            <span sec:authentication="name">관리자</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" th:href="@{/home}">메인 사이트</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <form th:action="@{/logout}" method="post">
                                    <button class="dropdown-item" type="submit">로그아웃</button>
                                </form>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h2 class="mb-4">관리자 대시보드</h2>
        
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-people fs-1 text-primary mb-3"></i>
                        <h5 class="card-title">사용자</h5>
                        <p class="card-text fs-4 fw-bold">2</p>
                        <a th:href="@{/admin/users}" class="btn btn-sm btn-outline-primary">사용자 관리</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-box-seam fs-1 text-success mb-3"></i>
                        <h5 class="card-title">상품</h5>
                        <p class="card-text fs-4 fw-bold">0</p>
                        <a th:href="@{/admin/products}" class="btn btn-sm btn-outline-success">상품 관리</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-cart-check fs-1 text-warning mb-3"></i>
                        <h5 class="card-title">주문</h5>
                        <p class="card-text fs-4 fw-bold">0</p>
                        <a th:href="@{/admin/orders}" class="btn btn-sm btn-outline-warning">주문 관리</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-graph-up fs-1 text-danger mb-3"></i>
                        <h5 class="card-title">매출</h5>
                        <p class="card-text fs-4 fw-bold">0원</p>
                        <a href="#" class="btn btn-sm btn-outline-danger">상세 통계</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="mb-0">테스트 데이터 생성</h5>
                    </div>
                    <div class="card-body">
                        <p>부하 테스트를 위한 데이터를 자동으로 생성합니다.</p>
                        <form id="generateDataForm">
                            <div class="row g-3 mb-3">
                                <div class="col-md-6">
                                    <label for="userCount" class="form-label">사용자 수</label>
                                    <input type="number" class="form-control" id="userCount" value="100" min="1" max="10000">
                                </div>
                                <div class="col-md-6">
                                    <label for="productCount" class="form-label">상품 수</label>
                                    <input type="number" class="form-control" id="productCount" value="1000" min="1" max="10000">
                                </div>
                            </div>
                            <button type="button" id="generateDataBtn" class="btn btn-primary">데이터 생성</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="mb-0">데이터 롤백</h5>
                    </div>
                    <div class="card-body">
                        <p>생성된 테스트 데이터를 롤백합니다. 관리자 계정과 기본 사용자 계정은 유지됩니다.</p>
                        <button type="button" id="rollbackDataBtn" class="btn btn-danger">데이터 롤백</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        document.getElementById('generateDataBtn').addEventListener('click', function() {
            const userCount = document.getElementById('userCount').value;
            const productCount = document.getElementById('productCount').value;
            
            fetch(`/admin/generate-test-data?userCount=${userCount}&productCount=${productCount}`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('테스트 데이터가 성공적으로 생성되었습니다.');
                    window.location.reload();
                } else {
                    alert('데이터 생성 실패: ' + data.message);
                }
            })
            .catch(error => {
                alert('오류가 발생했습니다: ' + error);
            });
        });
        
        document.getElementById('rollbackDataBtn').addEventListener('click', function() {
            if (confirm('정말로 테스트 데이터를 롤백하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                fetch('/admin/rollback-data', {
                    method: 'POST'
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('데이터가 성공적으로 롤백되었습니다.');
                        window.location.reload();
                    } else {
                        alert('데이터 롤백 실패: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('오류가 발생했습니다: ' + error);
                });
            }
        });
    </script>
</body>
</html> 